{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fake Review Detector</title>
    <link rel="stylesheet" href="{% static 'style.css' %}" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
</head>

<body>
  <!-- HERO SECTION -->
    <section class="hero-section">
        <div class="overlay">
            <div class="text-area">
                <h1>Fake Review Detector</h1>
                <p>Unmask the Truth in Every Review üîç</p>
                <a href="#scanner" class="start-btn">Start Scanning</a>
                <a href="{% url 'login' %}" class="start-btn">LogIn</a>
            </div>

        </div>
    </section>

    <!-- FEATURES SECTION -->
    <section class="features">
        <h2>AI-Powered Fake Review Detection System</h2>
        <div class="feature-container">


            <div class="feature-card">
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img src="https://i.postimg.cc/RZ1mFnBV/Screenshot-2025-10-19-110943.png" class="d-block w-100" alt="..." />
                        </div>
                        <div class="carousel-item">
                            <img src="https://i.postimg.cc/0jYKGfgz/Screenshot-2025-10-19-174203.png" class="d-block w-100" alt="..." />
                        </div>
                        <div class="carousel-item">
                            <img src="https://i.postimg.cc/rmqBFyVt/Screenshot-2025-10-19-174454.png" class="d-block w-100" alt="..." />
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>

                <h3>Smart Sentiment Analysis</h3>
                <p>Advanced NLP models analyze review tone, detect bias, and identify suspicious patterns.</p>
            </div>
            <div class="feature-card">
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img src="https://i.postimg.cc/ryvzRWv9/Screenshot-2025-10-19-110622.png" class="d-block w-100" alt="..." />
                        </div>
                        <div class="carousel-item">
                            <img src="https://i.postimg.cc/6qvgM8zR/Screenshot-2025-10-19-173811.png" class="d-block w-100" alt="..." />
                        </div>
                        <div class="carousel-item">
                            <img src="https://i.postimg.cc/cLsknkq5/Screenshot-2025-10-19-105937.png" class="d-block w-100" alt="..." />
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>

                <h3>Authenticity Score Engine</h3>
                <p>Each review is scored on coherence, style, and promotional language frequency.</p>
            </div>
            <div class="feature-card">
                <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img src="https://i.postimg.cc/RV9nhwrn/Screenshot-2025-10-19-104209.png" class="d-block w-100" alt="..." />
                        </div>
                        <div class="carousel-item">
                            <img src="https://i.postimg.cc/MGBBKxsy/Screenshot-2025-10-19-184020.png" class="d-block w-100" alt="..." />
                        </div>
                        <div class="carousel-item">
                            <img src="https://i.postimg.cc/W4tvM1Rf/Screenshot-2025-10-19-184624.png" class="d-block w-100" alt="..." />
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>

                <h3>AI Trust Graph</h3>
                <p>Visualize reviewer behavior and product trust ratings through interactive graphs.</p>
            </div>
        </div>
    </section>

    <!-- SCANNER SECTION -->
     
        <section class="scanner container my-5" id="scanner">
            <h2 class="text-center mb-4">Scan Review Bulk Test Samples</h2>
            <p class="muted">Paste your reviews below let AI detect truth or manipulation ‚ö°</p>

            <label for="reviews">Reviews (one per line):</label>
            <textarea id="reviews" class="form-control" rows="6"
                placeholder="Type or paste reviews here..."></textarea>
            <div class="text-center mt-3">
                <button id="scanBtn" class="btn btn-primary">ü§ñ Start Scan</button>
                <button id="clearBtn" class="btn btn-secondary ml-2">üßπ Clear</button>
            </div>
            <div id="details" class="mt-4 results">
            <h2>Scan Result</h2>
            
            <div id="resultArea">No results yet.</div>
            <div class="result-box" id="resultBox" style="display: none;"></div><br>
            <a href="{% url 'history' %}"id="clearBtn" class="btn btn-secondary ml-2 ">üß≠ MilestoneMap</a>
        </section>       
    </div>
</div>

        
    
    
<!-- FOOTER -->
    <footer>
        <p>¬© 2025 Fake Review Detector | Built with üíô for truth</p>
    </footer>
    
    <script>
document.getElementById("scanBtn").addEventListener("click", async () => {
    const text = document.getElementById("reviews").value.trim();
    const resultArea = document.getElementById("resultArea");
    const resultBox = document.getElementById("resultBox");

    if (!text) {
        resultBox.style.display = "none";
        resultArea.innerHTML = "<p style='color:#ff8080;'>‚ö†Ô∏è Please enter some text to analyze.</p>";
        return;
    }

    resultArea.innerHTML = "‚è≥ Analyzing...";
    resultBox.style.display = "none";

    try {
        const res = await fetch("/predict/", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": getCookie("csrftoken")
            },
            body: JSON.stringify({ reviews: text })
        });

        const data = await res.json();

        if (res.ok) {
            let html = "";
            data.results.forEach((item, i) => {
                html += `
                <div class="result-card">
                    <h4><strong>Review ${i + 1}:${item.review}</h4>
                    <h5>Prediction:
                        <span class="${item.prediction.includes('Fake') ? 'fake' : 'real'}">
                            ${item.prediction}
                        </span>
                    </h5>
                    <h4>TrueWave: ${item.real_confidence}% | FauxPulse: ${item.fake_confidence}%</h4>
                    <div class="progress mt-2">
                        <div class="progress-bar bg-success" role="progressbar"
                            style="width: ${item.real_confidence}%"
                            aria-valuenow="${item.real_confidence}" aria-valuemin="0" aria-valuemax="100"></div>
                        <div class="progress-bar bg-danger" role="progressbar"
                            style="width: ${item.fake_confidence}%"
                            aria-valuenow="${item.fake_confidence}" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>`;
            });

            resultArea.innerHTML = "";
            resultBox.innerHTML = html;
            resultBox.style.display = "block"; // show box when results exist
        } else {
            resultBox.style.display = "none";
            resultArea.innerHTML = "‚ùå " + (data.error || "Server error");
        }
    } catch (err) {
        console.error(err);
        resultBox.style.display = "none";
        resultArea.innerHTML = "‚ö†Ô∏è Could not connect to server.";
    }
});

document.getElementById("clearBtn").addEventListener("click", () => {
    document.getElementById("reviews").value = "";
    document.getElementById("resultArea").innerHTML = "No results yet.";
    document.getElementById("resultBox").style.display = "none";
});

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== "") {
        const cookies = document.cookie.split(";");
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === name + "=") {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
</script>
